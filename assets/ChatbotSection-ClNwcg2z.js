import{j as e}from"./ui-components-DfywtIQG.js";import{r as o}from"./react-vendor-CAIQhEhM.js";import E from"./react-spline-CDU72ySG.js";import{g as O}from"./Navbar-CVU6jdhU.js";import{A as D,m as C}from"./framer-motion-DP8BS7SU.js";import{M as $,r as z,a as P}from"./markdown-J8p8yzQs.js";import"./index-B-XMBNW3.js";import"./x-DSUXltcW.js";function _(m){let t=m.replace(/\\n/g,`
`).replace(/\*\*/g,"**").replace(/\*/g,"*").trim();const n=[];return t=t.replace(/```([\s\S]*?)```/g,s=>(n.push(s),`__EXISTING_CODE_BLOCK_${n.length-1}__`)),t=t.replace(/^([A-Z][A-Z\s]+)$/gm,s=>`## ${s.trim()}`),t=t.replace(/^(\d+\.\s+)([A-Z][A-Z\s]+)$/gm,(s,r,p)=>`### ${r}${p}`),t=t.replace(/^(\s*)-\s+(.+)$/gm,(s,r,p)=>`${r}- ${p.trim()}`),t=t.split(/\n\n+/).map(s=>s.includes("__EXISTING_CODE_BLOCK_")?s:[/^import\s+[\w_.]+/m,/^from\s+[\w_.]+\s+import/m,/^def\s+\w+\s*\(/m,/^class\s+\w+/m,/^\s*for\s+\w+\s+in\s+/m,/^\s*if\s+.+:/m,/^\s*while\s+.+:/m,/^\s*with\s+.+:/m,/^\s*try:/m,/^\s*except\s+/m,/^\s*\w+\s*=\s*{/m,/^\s*\w+\s*=\s*\[/m,/^\s*print\(/m,/^ydl_opts\s*=/m].some(x=>x.test(s))?`\`\`\`python
${s}
\`\`\``:s).join(`

`),t=t.replace(/__EXISTING_CODE_BLOCK_(\d+)__/g,(s,r)=>n[parseInt(r)]),t}console.log("Mode:","production");const H=({content:m})=>{const[t,n]=o.useState(!1),i=()=>{navigator.clipboard.writeText(m).then(()=>{n(!0),setTimeout(()=>n(!1),2e3)}).catch(u=>{console.error("Failed to copy: ",u)})};return e.jsx("button",{onClick:i,className:"absolute right-2 top-2 bg-gray-700 hover:bg-gray-600 text-gray-200 rounded px-2 py-1 text-xs flex items-center transition-colors z-10",title:"Copier le code",children:t?e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Copié"]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:[e.jsx("path",{d:"M8 2a1 1 0 000 2h2a1 1 0 100-2H8z"}),e.jsx("path",{d:"M3 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v6h-4.586l1.293-1.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L10.414 13H15v3a2 2 0 01-2 2H5a2 2 0 01-2-2V5zM15 11h2a1 1 0 110 2h-2v-2z"})]}),"Copier"]})})};function L(m,t,n){if(typeof n=="string"&&!n.includes("[object Object]"))return n;try{const i=new RegExp("```"+t+"\\n([\\s\\S]*?)```","g"),u=[...m.matchAll(i)];if(u.length>0&&u[0][1])return u[0][1].trim();const s=/```(?:\w*)\n([\s\S]*?)```/g,r=[...m.matchAll(s)];if(r.length>0&&r[0][1])return r[0][1].trim()}catch(i){console.error("Error extracting code:",i)}return String(n).replace(/\[object Object\]/g,"").replace(/,/g,"").trim()}const G=()=>e.jsx("div",{className:"w-full h-full",style:{pointerEvents:"none"},children:e.jsx(E,{scene:"https://prod.spline.design/fxkQcgSmamcJ1nJr/scene.splinecode",style:{width:"100%",height:"100%"}})}),Q=()=>{const m=o.useRef(null),t=o.useRef(null),n=o.useRef(null),i=o.useRef(null),[u,s]=o.useState(null),[r,p]=o.useState({text:"Bonjour ! Je suis Andriantahiry Nomena Hasina, développeur fullstack, cloud practitioner et spécialiste en automatisation. Comment puis-je vous aider aujourd'hui ?",isBot:!0,timestamp:new Date}),[x,v]=o.useState(""),[b,j]=o.useState(!1),[k,N]=o.useState(0),[M,S]=o.useState(!1),[R,B]=o.useState(""),[I,T]=o.useState([]);o.useEffect(()=>{r&&r.text&&B(_(r.text))},[r]);const A=async l=>{if(l.preventDefault(),l.stopPropagation(),!x.trim())return;s({text:x,isBot:!1,timestamp:new Date}),v(""),j(!0),setTimeout(()=>{var c;(c=i.current)==null||c.scrollIntoView({behavior:"smooth",block:"start"})},300);const h={role:"user",parts:[{text:x}]},g=[...I,h];try{const c=await fetch(O("/chat"),{mode:"no-cors",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:x,history:g})});console.log("Réponse du backend (opaque avec no-cors):",c);const d="Désolé, en raison de problèmes techniques (CORS), je ne peux pas générer de réponse complète. Veuillez contacter l'administrateur du site.",f={text:d,isBot:!0,timestamp:new Date},y={role:"model",parts:[{text:d}]};T([...g,y]),j(!1),p(f),N(w=>w+1),S(!1)}catch(c){console.error("Error:",c),j(!1),S(!0),p({text:"Je suis désolé, je rencontre des difficultés de connexion. Pourriez-vous réessayer dans quelques instants ?",isBot:!0,timestamp:new Date}),N(d=>d+1)}};return e.jsxs("div",{className:"py-16 px-4",id:"chatbot-section",ref:m,tabIndex:-1,style:{outline:"none"},children:[" ",e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("h2",{ref:i,className:"text-3xl font-bold text-center mb-8 text-foreground",children:[" ","Assistant Virtuel",M&&e.jsx("span",{className:"text-xs ml-2 text-red-500",children:"(mode hors-ligne)"})]}),e.jsx("h4",{className:"text-center mb-8 text-foreground",children:"Modèle de Gemini light"}),e.jsx("div",{className:"h-72 mb-8 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-lg shadow-lg overflow-hidden flex items-center justify-center",children:e.jsx(G,{})}),e.jsx("div",{className:"mb-8",children:e.jsx(D,{mode:"wait",children:b?e.jsx(C.div,{className:"flex justify-center",children:e.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-2xl",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-300 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-300 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400 dark:bg-gray-300 animate-bounce",style:{animationDelay:"300ms"}})]})})}):e.jsx(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.4},className:"w-full flex justify-center",children:e.jsx("div",{className:"w-full bg-card text-card-foreground rounded-xl shadow-lg overflow-hidden",children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"prose prose-lg prose-indigo dark:prose-invert max-w-none",children:e.jsx($,{remarkPlugins:[P],rehypePlugins:[z],components:{h2:({node:l,...a})=>e.jsx("h2",{className:"text-2xl font-bold my-6 text-primary tracking-wide",...a}),h3:({node:l,...a})=>e.jsx("h3",{className:"text-xl font-semibold my-4 text-foreground",...a}),ul:({node:l,...a})=>e.jsx("ul",{className:"my-4 space-y-2 list-none",...a}),li:({node:l,...a})=>e.jsxs("li",{className:"flex items-start space-x-2 my-2",...a,children:[e.jsx("span",{className:"text-primary mt-1",children:"•"}),e.jsx("span",{className:"text-foreground",children:a.children})]}),code:({node:l,inline:a,className:h,children:g,...c})=>{const d=/language-(\w+)/.exec(h||""),f=d?d[1]:"plaintext",y=g||"",w=d?L(R,f,String(y)):String(y);return!a&&d?e.jsxs("div",{className:"relative",children:[e.jsx(H,{content:w}),e.jsxs("pre",{className:"bg-gray-900 text-gray-200 p-4 rounded-lg mt-2 overflow-x-auto font-mono text-sm",children:[e.jsx("div",{className:"px-4 py-2 bg-gray-800 text-gray-400 text-xs",children:f}),e.jsx("code",{className:h,...c,children:g})]})]}):e.jsx("code",{className:h,...c,children:g})}},children:_(r.text)})})})})},`response-${k}`)})}),e.jsxs("form",{ref:t,onSubmit:A,className:"flex gap-2",children:[e.jsx("input",{ref:n,type:"text",value:x,onChange:l=>v(l.target.value),placeholder:"Tapez votre message ici...",className:"flex-1 p-4 rounded-full border border-input bg-background text-foreground dark:text-white placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:ring-2 focus:ring-primary focus:border-transparent shadow-sm"}),e.jsx("button",{type:"submit",className:"px-6 py-4 bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-700 hover:to-violet-700 text-white font-medium rounded-full shadow-lg transition-all duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:b,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})]})]})};export{Q as default};
